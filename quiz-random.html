<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz by Levels & Categories</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #e0eafc, #cfdef3);
    }
    #timer {
      font-size: 1.2rem;
      font-weight: bold;
      color: #dc3545;
    }
    .level-btn, .category-btn {
      font-size: 1.1rem;
      padding: 10px 20px;
      border-radius: 50px;
    }
    .card {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-radius: 1rem;
    }
    #quiz-container {
      max-width: 600px;
      margin: auto;
    }
    #result {
      padding: 1rem;
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    #question-info {
      font-size: 1rem;
      font-weight: normal;
      color: #007bff;
    }
  </style>
</head>
<body>
<div class="container py-5 text-center">
  <h1 class="display-5 fw-bold mb-4">üéØ Quiz Challenge</h1>
  <p class="lead mb-4">Choose a category and difficulty level to start!</p>

  <div class="mb-3">
    <h5>Choose Category</h5>
    <button class="btn btn-info mx-2 category-btn" onclick="selectCategory('math')">Math</button>
    <button class="btn btn-secondary mx-2 category-btn" onclick="selectCategory('history')">History</button>
  </div>

  <div id="difficulty-buttons" class="d-none mb-4">
    <h5>Choose Difficulty</h5>
    <button class="btn btn-success mx-2 level-btn" onclick="startQuiz('easy')">Easy</button>
    <button class="btn btn-warning mx-2 level-btn" onclick="startQuiz('medium')">Medium</button>
    <button class="btn btn-danger mx-2 level-btn" onclick="startQuiz('hard')">Hard</button>
  </div>

  <div id="quiz-container" class="card d-none">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 id="question" class="card-title mb-0 text-start"></h5>
        <div id="timer"></div>
      </div>
      <div id="question-info" class="mb-3"></div>
      <div id="options" class="mb-3 text-start"></div>
      <button class="btn btn-primary w-100" onclick="nextQuestion()">Next Question</button>
    </div>
  </div>

  <div id="result" class="mt-4 fw-bold fs-4 d-none"></div>
  <button id="export-btn" class="btn btn-success mt-2 d-none" onclick="exportPDF()">Export Results as PDF</button>
  <button id="restart-btn" class="btn btn-secondary mt-3 d-none" onclick="restartQuiz()">Restart Quiz</button>
</div>

<audio id="correctSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_f668f7b88f.mp3"></audio>
<audio id="wrongSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_84bce54541.mp3"></audio>
<audio id="timeoutSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_6f2f1b4dc8.mp3"></audio>

<script>
  const quizData = {
    math: {
      easy: [
        { q: "What is 2 + 2?", options: ["3", "4", "5", "6"], answer: 1 },
        { q: "What is 5 - 3?", options: ["3", "1", "2", "0"], answer: 2 }
      ],
      medium: [
        { q: "What is 12 / 4?", options: ["2", "3", "4", "6"], answer: 1 },
        { q: "What is 3 * 3?", options: ["6", "7", "8", "9"], answer: 3 }
      ],
      hard: [
        { q: "What is the derivative of x^2?", options: ["2x", "x", "x^2", "2"], answer: 0 },
        { q: "What is the integral of 2x?", options: ["x^2", "2x", "x^2 + C", "None"], answer: 2 }
      ]
    },
    history: {
      easy: [
        { q: "Who was the first President of the USA?", options: ["Lincoln", "Washington", "Jefferson", "Adams"], answer: 1 },
        { q: "Where is the Great Wall located?", options: ["India", "China", "Egypt", "Russia"], answer: 1 }
      ],
      medium: [
        { q: "When did WW2 end?", options: ["1940", "1945", "1950", "1939"], answer: 1 },
        { q: "Who discovered America?", options: ["Columbus", "Magellan", "Cook", "Vespucci"], answer: 0 }
      ],
      hard: [
        { q: "Who wrote the Iliad?", options: ["Plato", "Homer", "Socrates", "Aristotle"], answer: 1 },
        { q: "In what year did the Berlin Wall fall?", options: ["1985", "1987", "1989", "1991"], answer: 2 }
      ]
    }
  };

  const timeLimits = { easy: 15, medium: 13, hard: 12 };
  let currentCategory = '';
  let currentLevel = '';
  let currentQuestion = 0;
  let score = 0;
  let timerInterval;
  let timeLeft;
  let results = [];

  function selectCategory(category) {
    currentCategory = category;
    document.getElementById("difficulty-buttons").classList.remove("d-none");
  }

  function startQuiz(level) {
    currentLevel = level;
    currentQuestion = 0;
    score = 0;
    results = [];
    document.getElementById("quiz-container").classList.remove("d-none");
    document.getElementById("result").classList.add("d-none");
    document.getElementById("export-btn").classList.add("d-none");
    document.getElementById("restart-btn").classList.add("d-none");
    showQuestion();
  }

  function showQuestion() {
    clearInterval(timerInterval);
    const q = quizData[currentCategory][currentLevel][currentQuestion];
    document.getElementById("question").innerText = q.q;
    document.getElementById("question-info").innerText = `Question ${currentQuestion + 1} / ${quizData[currentCategory][currentLevel].length}`;
    document.getElementById("options").innerHTML = q.options.map((opt, index) =>
      `<div class="form-check">
        <input class="form-check-input" type="radio" name="option" value="${index}" id="opt${index}">
        <label class="form-check-label" for="opt${index}">${opt}</label>
      </div>`).join('');
    startTimer();
  }

  function startTimer() {
    timeLeft = timeLimits[currentLevel];
    document.getElementById("timer").innerText = `‚è± ${timeLeft}s`;
    timerInterval = setInterval(() => {
      timeLeft--;
      document.getElementById("timer").innerText = `‚è± ${timeLeft}s`;
      if (timeLeft <= 0) {
        document.getElementById("timeoutSound").play();
        clearInterval(timerInterval);
        nextQuestion(true);
      }
    }, 1000);
  }

  function nextQuestion(auto = false) {
    const selected = document.querySelector('input[name="option"]:checked');
    const q = quizData[currentCategory][currentLevel][currentQuestion];
    const correct = q.answer;

    if (!selected && !auto) {
      alert("Please select an option!");
      return;
    }

    const selectedAnswer = selected ? parseInt(selected.value) : -1;
    if (selectedAnswer === correct) {
      score++;
      document.getElementById("correctSound").play();
    } else if (!auto) {
      document.getElementById("wrongSound").play();
    }

    results.push({ question: q.q, selected: q.options[selectedAnswer] || "Not Answered", correct: q.options[correct] });

    currentQuestion++;
    if (currentQuestion < quizData[currentCategory][currentLevel].length) {
      showQuestion();
    } else {
      clearInterval(timerInterval);
      document.getElementById("quiz-container").classList.add("d-none");
      document.getElementById("result").classList.remove("d-none");
      document.getElementById("result").innerText = `üéâ Your Score: ${score} / ${quizData[currentCategory][currentLevel].length}`;
      document.getElementById("export-btn").classList.remove("d-none");
      document.getElementById("restart-btn").classList.remove("d-none");
    }
  }

  function restartQuiz() {
    const confirmRestart = confirm("Are you sure you want to restart the quiz?");
    if (confirmRestart) {
      startQuiz(currentLevel);
    }
  }

  async function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.text("Quiz Results", 10, 10);
    results.forEach((r, i) => {
      doc.text(`${i + 1}. ${r.question}`, 10, 20 + i * 20);
      doc.text(`Your Answer: ${r.selected}`, 10, 25 + i * 20);
      doc.text(`Correct Answer: ${r.correct}`, 10, 30 + i * 20);
    });
    doc.save("quiz-results.pdf");
  }
</script>
</body>
</html>
